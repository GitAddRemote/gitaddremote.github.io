{"componentChunkName":"component---src-templates-blog-post-js","path":"/recreating-map-function-with-promises/","webpackCompilationHash":"a3303e4a314dc218d01b","result":{"data":{"site":{"siteMetadata":{"title":"GitAddRemote","author":"Demian","menuLinks":[{"name":"Home","link":"/"},{"name":"JavaScript","link":"/javascript"},{"name":"Remote","link":"/remote"},{"name":"About","link":"/about"}]}},"markdownRemark":{"id":"390bfea4-6fff-51ab-9d24-9993861a0a3b","excerpt":"A common practice when hiring a new developer is to have them complete a practical coding test. This can be completed via a take home project. Often however…","html":"<p>A common practice when hiring a new developer is to have them complete a practical coding test. This can be completed via a take home project. Often however, the developer is asked to complete a practical code test during the interview. While I understand why this happens, I don’t believe setting up an adversarial situation during the interview process is ideal when hiring a new candidate. That said, it is a fact of life we as developers have to work through. As such it is a great idea to complete regular programmatic challenges as part of our interview preparation. Today, I decided to remake the Array.map function using promises for just a such a challenge.</p>\n<h2>What Is The Map Function</h2>\n<p>The <a href=\"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/map\">map method</a> was added to the Array global object with the release of ES6, along with the similar <a href=\"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/filter\">filter</a> and <a href=\"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/Reduce\">reduce</a> methods. Per the documentation the intended purpose is: </p>\n<blockquote>\n<p>“The map() method creates a new array with the results of calling a provided function on every element in the calling array.”</p>\n</blockquote>\n<p>This method is largely syntatic sugar, but wow does it make our code so much more readable, and easier to work with. Both of these things, along with standardizing a boilerplate code pattern make the map function another great addition to the JavaScript language as it continues to mature.</p>\n<h2>Why Recreate The Array Map Function</h2>\n<p>As I said, running through coding challenges is a great way to sharpen your mental toolbox. The Map function has been around since ES6 which means while it may not be brand new, it certainly isn’t that old either. A friend recently was asked to complete a similar challenge during an interview. I figure if the challenge is good enough for a real interview process, it is good enough to start off with our first coding challenge for the blog.</p>\n<h2>Let’s Setup The New Function</h2>\n<p>Let’s setup the new function, even though there is not much to it. We start off by adding a new function to the Array prototype using the Object.define function. This function accepts one argument which is the callback we will call on every iteration through the array. Once we have the function shell created we can go ahead and setup our return variable. We also setup the promise we will return once our map function is completed with it’s task.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-javascript line-numbers\"><code class=\"language-javascript\"><span class=\"token comment\">/**\n * Making an async array map function\n */</span>\nObject<span class=\"token punctuation\">.</span><span class=\"token function\">defineProperty</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Array</span><span class=\"token punctuation\">.</span>prototype<span class=\"token punctuation\">,</span> <span class=\"token string\">\"maptronic\"</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span>\n  enumerable<span class=\"token punctuation\">:</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">,</span>\n  configurable<span class=\"token punctuation\">:</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">,</span>\n  <span class=\"token function-variable function\">value</span><span class=\"token punctuation\">:</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">mapFunc</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">let</span> returnVal <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">return</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Promise</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">resolve<span class=\"token punctuation\">,</span> reject</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">try</span> <span class=\"token punctuation\">{</span>\n        console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'### In The New Function ###'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token function\">resolve</span><span class=\"token punctuation\">(</span>returnVal<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span> <span class=\"token keyword\">catch</span> <span class=\"token punctuation\">(</span>err<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token function\">reject</span><span class=\"token punctuation\">(</span>err<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>Now that we have the basic structure in place let’s talk about what it currently does. When we call the “maptronic” function on an array, it currently spits out the text ’### In The New Function ###’ to the console and then resolves the promise with the empty array as the returned data. We have access to the data in the original array itself at this point so let’s use that data to complete the function. (And, yes I realize I am adding a function property to a core object, but that is a totally different discussion.)</p>\n<h2>Let’s Iterate</h2>\n<p>Since we are currently in the array object itself, we have full access to the data of that array. Which means we can iterate over it and perform whatever action is needed. To access the data in the original array, we can call “this” to reference the array itself and then iterate using the forEach function. </p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-javascript line-numbers\"><code class=\"language-javascript\">  <span class=\"token comment\">/**\n   * Async map function\n   */</span>\n  Object<span class=\"token punctuation\">.</span><span class=\"token function\">defineProperty</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Array</span><span class=\"token punctuation\">.</span>prototype<span class=\"token punctuation\">,</span> <span class=\"token string\">\"maptronic\"</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span>\n    enumerable<span class=\"token punctuation\">:</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">,</span>\n    configurable<span class=\"token punctuation\">:</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">,</span>\n    <span class=\"token function-variable function\">value</span><span class=\"token punctuation\">:</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">mapFunc</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">let</span> returnVal <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n      <span class=\"token keyword\">return</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Promise</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">resolve<span class=\"token punctuation\">,</span> reject</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">try</span> <span class=\"token punctuation\">{</span>\n          <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">forEach</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">element</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n            <span class=\"token keyword\">const</span> found <span class=\"token operator\">=</span> <span class=\"token function\">mapFunc</span><span class=\"token punctuation\">(</span>element<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            returnVal<span class=\"token punctuation\">.</span><span class=\"token function\">push</span><span class=\"token punctuation\">(</span>found<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n          <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n          <span class=\"token function\">resolve</span><span class=\"token punctuation\">(</span>returnVal<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span> <span class=\"token keyword\">catch</span> <span class=\"token punctuation\">(</span>err<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n          <span class=\"token function\">reject</span><span class=\"token punctuation\">(</span>err<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>For each iteration through the array we take the current element and pass it into the callback function that was passed into the maptronic function. Once the callback function responds, we add the resulting value to the returnVal array. And finally, once the forEach loop is finished, we return the new promise passing the resulting new array as it’s data.</p>\n<h1>Code In Action</h1>\n<p>Let’s finish off by seeing our code in action using sample code. We will start off in the same file, creating an array of project numbers as our use case. Once we have this array in place, we will use it with our new maptronic function and ultimately display the updated values. These updated values will be created using the adjustProjectedNumbers function that we pass into the maptronic function.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-javascript line-numbers\"><code class=\"language-javascript\">  <span class=\"token comment\">// Original Array List</span>\n  <span class=\"token keyword\">const</span> baseProjectNumbers <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token number\">10</span><span class=\"token punctuation\">,</span> <span class=\"token number\">30</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3.2</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token comment\">// Use the new Array.maptronic function passing our custom function</span>\n  <span class=\"token keyword\">const</span> newArray <span class=\"token operator\">=</span> baseProjectNumbers<span class=\"token punctuation\">.</span><span class=\"token function\">maptronic</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">e<span class=\"token punctuation\">,</span> i<span class=\"token punctuation\">,</span> a</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">INDEX: </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>i<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">ORIGINAL ARR: </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>a<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">let</span> val <span class=\"token operator\">=</span> e <span class=\"token operator\">*</span> <span class=\"token number\">1.6</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">return</span> Number<span class=\"token punctuation\">.</span><span class=\"token function\">isInteger</span><span class=\"token punctuation\">(</span>val<span class=\"token punctuation\">)</span> <span class=\"token operator\">?</span> val <span class=\"token punctuation\">:</span> val<span class=\"token punctuation\">.</span><span class=\"token function\">toFixed</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token comment\">// Display updated values from new array</span>\n  console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> newArray <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>And there you have it. If all worked as expected you should have a ”{ newArray: Promise { [ 16, 48, ‘1.60’, ‘5.12’ ] } }” displayed in the console. When you called the “baseProjectNumbers.maptronic” function, we iterate over each value in the original array, apply the function “baseProjectNumbers” to each value in the original array, and then store that modified value in a new array. Once we finish iterating over the original array we return the new array with the updated values.</p>\n<h1>The End Result</h1>\n<p>As I said, the end result is really quite simple. There is no real reason to use this code. Not when we have a real, compiled map function with the release of ES6. This was simply an exercise that intrigued me when a friend mentioned it. And I think, this is a great way to hone your development skills. Small, projects like this make your mind think critically especially when you are adding to your polyglot catalog like me.</p>","frontmatter":{"title":"Recreating Map Function With Promises","date":"September 14, 2019","description":"","published":true}}},"pageContext":{"isCreatedByStatefulCreatePages":false,"slug":"/recreating-map-function-with-promises/","previous":{"fields":{"slug":"/20190916-001_create-production-ready-node-base-project/"},"frontmatter":{"title":"Create Production Ready Node Base Project","published":false,"categories":["javascript","api"]}},"next":{"fields":{"slug":"/20190915-001_add-a-configurable-navigation-bar-to-gatsby-blog/"},"frontmatter":{"title":"Add Configurable Navigation Bar To Gatsby Blog","published":false,"categories":["javascript"]}}}}}